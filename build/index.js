!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r(require("react"),require("recompose"),require("react-apollo"),require("@tapgiants/form"),require("@tapgiants/graphql"));else if("function"==typeof define&&define.amd)define(["React","recompose","react-apollo","@tapgiants/form","@tapgiants/graphql"],r);else{var t="object"==typeof exports?r(require("react"),require("recompose"),require("react-apollo"),require("@tapgiants/form"),require("@tapgiants/graphql")):r(e.React,e[void 0],e[void 0],e[void 0],e[void 0]);for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(this,function(e,r,t,n,o){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=5)}([function(r,t){r.exports=e},function(e,t){e.exports=r},function(e,r){e.exports=t},function(e,r){e.exports=n},function(e,r){e.exports=o},function(e,r,t){"use strict";t.r(r);var n=t(0),o=t.n(n),a=t(2),u=t(3);function i(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var c=function(e,r){return function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(r){i(e,r,t[r])})}return e}({},{input:e.props.fields.reduce(function(e,t){return"id"==t.name?e:void 0===r[t.name]||t.virtual?e:(e[t.name]=r[t.name],e)},{})},r.id?{id:r.id}:{})},l=function(e){var r=e.rawValues,t=void 0===r?{}:r,n=e.fields;if(!n)throw new Error("GQLForm fields prop not specified. fields prop describes form fields and default values.");return n.reduce(function(e,r){return t[r.name]?void 0!==r.primaryKey?e[r.name]=function(e,r){return e[r.name].map(function(e){return e[r.primaryKey]})}(t,r):r.nestedFields?e[r.name]=function(e,r){return e[r.name].map(function(e){return r.nestedFields.reduce(function(r,t){return r[t]=e[t],r},{})})}(t,r):r.valueMapper?e[r.name]=r.valueMapper(t[r.name]):e[r.name]=t[r.name]:void 0!==r.default&&(e[r.name]="function"==typeof r.default?r.default(t):r.default),e},{})},f=function(e,r){var t=e.charAt(0).toUpperCase()+e.slice(1);return"".concat(r.id?"update":"create").concat(t)};function p(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=function(e,r,t){var n=t.props,o=n.path,a=n.responseDataMapper,u=n.onSuccess,i=t.setSubmitting,c=p(t,["props","setSubmitting"]);if(!o&&!a)throw new Error("Specify at least one of the following GQLForm props: `path` or `responseDataMapper`. \n`path` prop is the key in the gql response where the excpected data is located. \n`responseDataMapper` prop is a callback that maps gql response and should return \nan object with errors and item keys");i(!1);var l=o?function(e,r,t){var n=f(r,t);return{item:e[n][r],errors:e[n].errors}}(e,o,r):a(e),s=l.errors,m=l.item;return s?Promise.reject(s):(u(m,c),Promise.resolve(m))},m=t(4),d=function(e,r){var t=r.setErrors;if(!Array.isArray(e))throw e.message;t(Object(m.formatGQLErrors)(e))},b=function(e,r){(0,r.props.form)({variables:c(r,e)}).then(function(t){var n=t.data;return s(n,e,r)}).catch(function(e){return d(e,r)})};function v(){return(v=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function y(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var O=function(e){var r,t=e.MarkupComponent,n=e.submitQuery,i=e.update,c=y(e,["MarkupComponent","submitQuery","update"]),f=(r=t,Object(u.withForm)({mapPropsToValues:l,handleSubmit:b})(r));return o.a.createElement(a.Mutation,{mutation:n,update:i},function(e){return o.a.createElement(f,v({form:e},c))})};O.defaultProps={rawValues:{}};var h=function(e){var r=e.id,t=e.query,n=e.path,u=y(e,["id","query","path"]);return o.a.createElement(a.Query,{query:t,variables:{input:{id:r}}},function(e){var r=e.loading,t=e.data;return r?"Loading...":o.a.createElement(O,v({rawValues:t[n],path:n},u))})},g=function(e){var r=e.id,t=e.path,n=e.valuesQuery,a=y(e,["id","path","valuesQuery"]);return r&&n?o.a.createElement(h,v({query:n,path:t,id:r},a)):o.a.createElement(O,v({path:t},a))};function j(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(r){w(e,r,t[r])})}return e}function w(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var P=function(e){var r=e.route,t=e.params,n=void 0===t?{}:t,a=e.pageInfo,u=a.startCursor,i=a.endCursor,c=a.hasPreviousPage,l=a.hasNextPage,f=e.totalCount,p=e.LinkComponent;return o.a.createElement("div",{className:"pagination"},c&&o.a.createElement(p,{route:r,params:j({},n,{before:u})},o.a.createElement("a",{className:"btn-secondary",rel:"previous_page"},"← Previous")),l&&o.a.createElement(p,{route:r,params:j({},n,{after:i})},o.a.createElement("a",{className:"btn-secondary",rel:"next"},"Next →")),o.a.createElement("span",{className:"current"},"Total: ",f))},E=o.a.createContext({}),S=function(e){var r=e.HeaderComponent;return o.a.createElement(E.Consumer,null,function(e){return o.a.createElement("thead",null,o.a.createElement(r,e))})},x=function(e){var r=e.renderItem;return o.a.createElement(E.Consumer,null,function(e){var t=e.list;return o.a.createElement("tbody",null,t.map(function(e){return r(e)}))})},q=function(e){var r=e.FooterComponent;return o.a.createElement(E.Consumer,null,function(e){return o.a.createElement(r,e)})};function C(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(r){F(e,r,t[r])})}return e}function F(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var k=function(e){var r=e.query,t=e.variables,n=e.filter,u=e.path,i=e.HeaderComponent,c=e.FooterComponent,l=e.renderItem;return o.a.createElement(a.Query,{query:r,variables:{input:t,filter:n}},function(e){var r=e.loading,t=e.data;return r?"Loading...":o.a.createElement(E.Provider,{value:C({},t[u])},o.a.createElement("table",{className:"data-grid"},o.a.createElement(S,{HeaderComponent:i}),o.a.createElement(x,{renderItem:l})),c&&o.a.createElement(q,{FooterComponent:c}))})},M=t(1),D=Object(M.compose)(a.withApollo,Object(M.withHandlers)({onDelete:function(e){var r=e.id,t=e.resource,n=e.client,o=e.mutation,a=e.onDelete,u=e.onErrors,i=e.update;return function(){n.mutate({mutation:o,variables:{input:{id:r}},update:i}).then(function(e){var r="delete".concat(t.charAt(0).toUpperCase()+t.slice(1)),n=e.data[r].errors;if(n)return Promise.reject(n);var o=e.data[r][t];return"function"==typeof a&&a(o),Promise.resolve(o)}).catch(function(e){return d(e,{setErrors:function(e){return u(e)}})})}}}));var Q=e=>Object.keys(e).reduce((r,t)=>({...r,...{[`filter[${t}]`]:e[t]}}),{});function L(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(r){I(e,r,t[r])})}return e}function I(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var N=Object(u.withForm)({mapPropsToValues:function(e){var r=e.fields,t=e.filterState;return r.reduce(function(e,r){return L({},e,I({},r.name,t[r.name]||r.default))},{})},handleSubmit:function(e,r){var t=r.props,n=t.router,o=t.route,a=t.params,u=void 0===a?{}:a;if(!o)throw new Error("FormFilter route prop not specified. route prop should be valid route path.");n.pushRoute(o,L({},u,Q(e)))}});function _(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var H=function(e,r){return e.reduce(function(e,t){return r["filter[".concat(t.name,"]")]?function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(r){_(e,r,t[r])})}return e}({},e,_({},t.name,r["filter[".concat(t.name,"]")])):e},{})},A=function(e){return Object(M.compose)(Object(M.withProps)(function(r){return{filter:H(e,r)}}),Object(M.withProps)(function(e){var r=e.filter;return{filterHttpParams:Q(r)}}))},T=Object(M.compose)(Object(M.withProps)(function(e){var r=e.after,t=void 0===r?"":r,n=e.before;return{pagingParams:{after:t,before:void 0===n?"":n}}})),V=function(e){return Object(M.compose)(T,A(e))},G=Object(M.compose)(Object(M.withProps)(function(e){var r=e.id;if(!r)throw new Error("Missing http get parameter id. ");return{id:r}}));t.d(r,"GQLForm",function(){return g}),t.d(r,"Pagination",function(){return P}),t.d(r,"List",function(){return k}),t.d(r,"withDeleteHandler",function(){return D}),t.d(r,"withFilterForm",function(){return N}),t.d(r,"withFilter",function(){return A}),t.d(r,"withPagingParams",function(){return T}),t.d(r,"withListParams",function(){return V}),t.d(r,"withId",function(){return G})}])});